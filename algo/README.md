## ACTIN-Algo

ACTIN-Algo matches a patient record (clinical & molecular data) with available treatments.

This application requires Java 11+ and can be run as follows: 

```
java -cp actin.jar com.hartwig.actin.algo.TreatmentMatcherApplication \
   -clinical_json /path/to/clinical.json \
   -molecular_json /path/to/molecular.json \
   -treatment_database_directory /path/to/potential_treatment_options \
   -output_directory /path/where/output/is/written \
```

The following assumptions are made about the inputs:
 - The clinical JSON adheres to the format that is generated by [ACTIN-Clinical](../clinical/README.md).
 - The molecular JSON is the [ORANGE](https://github.com/hartwigmedical/hmftools/blob/master/orange/README.md) 
 output from the [Hartwig platinum pipeline](https://github.com/hartwigmedical/platinum)
 - The treatment database directory is the output directory of [ACTIN-Treatment](../treatment/README.md)
 
### Treatment matching

Every treatment defined in the treatment database is evaluated independently. 

In case a treatment is a trial, all inclusion and exclusion criteria are evaluated for this trial as well as every criterion 
for any specific cohort within this trial.  

Every criterion evaluates to one of the following options:

Evaluation | Description
---|---
PASS | The patient complies with the inclusion or exclusion criterion.  
PASS_BUT_WARN | The patient complies with the inclusion or exclusion criterion but a manual check is required.
FAIL | The patient does not comply with the inclusion or exclusion criterion. 
UNDETERMINED | The data provided to the inclusion or exclusion criterion is insufficient for determining eligibility.
NOT_IMPLEMENTED | No algo has been defined yet for this criterion.

For every trial (and cohort) an overall evaluation is determined using the following algorithm:
 1. A patient is eligible for a trial (or cohort) only in case all criteria are `PASS` or `PASS_BUT_WARN`.
 1. In case one of the criteria evaluates to a `FAIL` the patient fails overall eligibility for the trial (or cohort). 
 1. In case of no fails but at least one `UNDETERMINED` or `NOT_IMPLEMENTED` evaluation, the overall evaluation is determined 
 to be `UNDETERMINED`.    

The following additional rules are applied for trials versus cohorts:
 1. A patient is eligible for a specific cohort only if the overall evaluation for both the cohort as well as the trial itself are passed.
 1. A patient is eligible for a trial only if it is eligible for at least one of the cohorts within the trial or if the trial has no 
 cohorts defined and the patient passes all criteria for the trial.  

#### Individual criteria algorithms

Inclusion and exclusion criteria can be defined as composite functions. The following composite functions are available:

Function | Description 
---|---
AND | -
NOT | -
OR | _
WARN_ON_FAIL | 

##### General rules

Rule | When does a patient pass evaluation?
---|---
IS_AT_LEAST_18_YEARS_OLD | -
IS_BREASTFEEDING | -
IS_PREGNANT | - 
HAS_LIFE_EXPECTANCY_OF_AT_LEAST_X_WEEKS | -
HAS_WHO_STATUS_OF_AT_MOST_X | - 
HAS_HAD_SURGERY_WITHIN_LAST_X_WEEKS | -

##### Rules related to pathology assessments

Rule | When does a patient pass evaluation?
---|---
PRIMARY_TUMOR_LOCATION_BELONGS_TO_DOID_X | -

##### Rules related to radiology assessments
 
Rule | When does a patient pass evaluation?
---|---
HAS_ADVANCED_CANCER | -
HAS_METASTATIC_CANCER | -
HAS_LIVER_METASTASES | -
HAS_ACTIVE_CNS_METASTASES | -
HAS_MEASURABLE_DISEASE_RECIST | - 
HAS_BIOPSY_AMENABLE_LESION | -

##### Rules related to previously received cancer treatments or prior other tumors

Rule | When does a patient pass evaluation?
---|---
HAS_EXHAUSTED_SOC_TREATMENTS | - 
HAS_DECLINED_SOC_TREATMENTS | -
HAS_HAD_MAX_X_NR_ANTI_PD_L1_OR_PD_1_IMMUNOTHERAPIES | -
HAS_HISTORY_OF_SECOND_MALIGNANCY | -
SECOND_MALIGNANCY_HAS_BEEN_CURED_SINCE_X_YEARS | -

##### Rules related to recent laboratory measurements

Rule | When does a patient pass evaluation?
---|---
HAS_LEUKOCYTES_ABS_OF_AT_LEAST_X | -
HAS_HEMOGLOBIN_G_PER_DL_OF_AT_LEAST_X | -
HAS_THROMBOCYTES_ABS_AT_LEAST_X | -
HAS_CREATININE_ULN_OF_AT_MOST_X | -
HAS_CREATININE_CLEARANCE_CKD_EPI_OF_AT_LEAST_X | -
HAS_TOTAL_BILIRUBIN_ULN_AT_MOST_X | -
HAS_DIRECT_BILIRUBIN_ULN_AT_MOST_X | -
HAS_ASAT_ULN_OF_AT_MOST_X | -
HAS_INR_ULN_AT_MOST_X | -
HAS_PT_ULN_AT_MOST_X | -
HAS_APTT_ULN_AT_MOST_X | -

##### Rules related on current other conditions

Rule | When does a patient pass evaluation?
---|---
HAS_ACTIVE_INFECTION | -
HAS_SIGNIFICANT_CONCOMITANT_ILLNESS | -
HAS_HISTORY_OF_AUTOIMMUNE_DISEASE | -
HAS_HISTORY_OF_CARDIAC_DISEASE | -
HAS_KNOWN_HEPATITIS_B_INFECTION | -
HAS_KNOWN_HEPATITIS_C_INFECTION | -
HAS_KNOWN_HIV_INFECTION | -
HAS_GILBERT_DISEASE | -

##### Rules depending on current medication

Rule | When does a patient pass evaluation?
---|---
HAS_ALLERGY_RELATED_TO_STUDY_MEDICATION | -
HAS_STABLE_ANTICOAGULANT_DOSING | -
HAS_TOXICITY_OF_AT_LEAST_GRADE_X | -
HAS_TOXICITY_OF_AT_LEAST_GRADE_X_IN_NEUROPATHY | -
CURRENTLY_GETS_IMMUNOSUPPRESSANT_MEDICATION | -
CURRENTLY_GETS_CORTICOSTEROID_MEDICATION | -

##### Rules related to blood pressure measurements

Rule | When does a patient pass evaluation?
---|---
HAS_SBP_MMHG_OF_AT_LEAST_X | -
HAS_DBP_MMHG_OF_AT_LEAST_X | -

##### Rules related to blood transfusions

Rule | When does a patient pass evaluation?
---|---
HAS_HAD_ERYTHROCYTE_TRANSFUSION_WITHIN_LAST_X_WEEKS | -
HAS_HAD_THROMBOCYTE_TRANSFUSION_WITHIN_LAST_X_WEEKS | -
 
### Version History and Download Links
 - Upcoming (first release) 